(this.webpackJsonparkareact=this.webpackJsonparkareact||[]).push([[0],{21:function(e,t,a){e.exports=a.p+"static/media/gameOver.b6bfcd79.mp3"},22:function(e,t,a){e.exports=a.p+"static/media/tryAgain.9cae2b3e.mp3"},23:function(e){e.exports=JSON.parse('{"a":[{"layers":[[{"position":[0,2.5,-10],"userDataType":"blue"},{"position":[-5,0,-10],"userDataType":"yellow"},{"position":[0,0,-10],"userDataType":"yellow"},{"position":[5,0,-10],"userDataType":"yellow"},{"position":[0,-2.5,-10],"userDataType":"blue"}],[{"position":[-2.5,1.25,-5],"userDataType":"pink"},{"position":[2.5,1.25,-5],"userDataType":"pink"},{"position":[-2.5,-1.25,-5],"userDataType":"red"},{"position":[2.5,-1.25,-5],"userDataType":"red"}]]}]}')},25:function(e,t,a){e.exports=a.p+"static/media/brick.eed03f13.mp3"},26:function(e,t,a){e.exports=a.p+"static/media/wall.4c0964a4.mp3"},31:function(e,t,a){e.exports=a.p+"static/media/cross.00397b42.jpg"},37:function(e,t,a){e.exports=a(46)},45:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(9),i=a.n(o),s=a(3),c=a(13),l=a(21),u=a.n(l),m=a(22),f=a.n(m),d=Object(c.a)((function(e,t){return{score:0,balls:3,inGame:!1,ballLaunched:!1,currentLevel:1,launchBall:function(){e((function(){return{ballLaunched:!0}}))},launchGame:function(){e((function(){return{inGame:!0}}))},resetGame:function(){e((function(){return{balls:3,score:0,inGame:!1}}))},resetBall:function(){return e((function(){return{ballLaunched:!1}}))},getRemainingBalls:function(){return t((function(){}))},addScore:function(){e((function(e){return{score:e.score+1}}))},retrieveBall:function(){t().balls>0?new Audio(f.a).play():new Audio(u.a).play();e((function(e){return{balls:e.balls-1}}))}}})),h=Object(s.a)(d,1)[0],p=Object(c.a)((function(e,t){return{tiles:[],getTiles:function(){return t().tiles},buildLevel:function(t){e((function(){return{tiles:t}}))}}})),v=Object(s.a)(p,1)[0],b=a(23);function g(){var e=h((function(e){return e})).launchGame,t=v().buildLevel;return Object(n.useEffect)((function(){t(b.a[0].layers.flat())}),[t]),r.a.createElement("div",{id:"welcome",onClick:e,style:{margin:"auto"}},"Click to start")}var y=a(6),E=a(47),x=a(1),D=a(24),w=a.n(D),O=a(25),M=a.n(O),j=a(26),P=a.n(j),F=r.a.createContext({glitching:!1,setGlitching:function(){}});function _(e){var t=e.position,a=e.size,o=void 0===a?[2,2,2]:a,i=e.userData,c=e.id,l=h(),u=l.retrieveBall,m=l.resetBall,f=Object(n.useContext)(F).setGlitching,d=isNaN(i.strength),p=isNaN(i.isCorner),v=Object(n.useState)(),b=Object(s.a)(v,2),g=b[0],D=b[1];var O=null;d?O=P.a:i.isRoof||(O=M.a);var j=new w.a(O),_=Object(y.e)().scene,C=Object(E.c)((function(){return{type:p?"Static":"Kinematic",args:o.map((function(e){return e/2})),position:t,userData:i,onCollide:function(e){j.play(),d?i.isRoof&&(m(),f(!0),setTimeout((function(){f(!1),u()}),300)):(i.strength--,G.position.set(-1e3,-1e3,-100),D(function(){for(var e=new x.Geometry,t=new x.PointsMaterial({color:i.color,size:.9,transparent:!0,depthTest:!1,sizeAttenuation:!0,opacity:.9}),a=0;a<25;a++){var n=2.5*Math.random()-1.25+z.current.position.x,r=2.5*Math.random()-1.25+z.current.position.y,o=2.5*Math.random()-1.25+z.current.position.z,s=new x.Vector3(n,r,o);e.vertices.push(s)}var c=new x.Points(e,t);return c.customRotation=2*Math.random()-1,_.add(c),c}()))}}})),S=Object(s.a)(C,2),z=S[0],G=S[1];return Object(y.c)((function(){g&&g.material.opacity>0&&(g.material.opacity-=.0075,g.scale.x+=.01,g.scale.y+=.01,g.rotation.x+=g.customRotation/50)})),r.a.createElement("mesh",{key:c,ref:z,receiveShadow:!0,userData:i},r.a.createElement("boxGeometry",{attach:"geometry",args:o}),r.a.createElement("meshStandardMaterial",{attach:"material",color:i.color}))}var C=a(5);function S(e){var t=e.position,a=e.userData;return r.a.createElement(_,{position:t,userData:a})}function z(){return(0,v().getTiles)().map((function(e,t){return r.a.createElement(S,{key:t,position:e.position,userData:C.a[e.userDataType]})}))}function G(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(_,{position:[-12.5,0,0],userData:C.b.side,size:[1,25,130]}),r.a.createElement(_,{position:[12.5,0,0],userData:C.b.side,size:[1,25,130]}),r.a.createElement(_,{position:[0,12.5,0],userData:C.b.side,size:[25,1,130]}),r.a.createElement(_,{position:[0,-12.5,0],userData:C.b.side,size:[25,1,130]}),r.a.createElement(_,{position:[0,0,-12.5],userData:C.b.ground,size:[25,25,1],rotation:Math.PI/2}),r.a.createElement(_,{position:[-12,-12,-12.5],userData:C.b.corner,size:[.25,.25,130],rotation:Math.PI/2}),r.a.createElement(_,{position:[-12,12,-12.5],userData:C.b.corner,size:[.25,.25,130],rotation:Math.PI/2}),r.a.createElement(_,{position:[12,12,-12.5],userData:C.b.corner,size:[.25,.25,130],rotation:Math.PI/2}),r.a.createElement(_,{position:[12,-12,-12.5],userData:C.b.corner,size:[.25,.25,130],rotation:Math.PI/2}),r.a.createElement(_,{position:[0,12,-12],userData:C.b.corner,size:[130,.25,.25],rotation:Math.PI/2}),r.a.createElement(_,{position:[0,-12,-12],userData:C.b.corner,size:[130,.25,.25],rotation:Math.PI/2}),r.a.createElement(_,{position:[12,0,-12],userData:C.b.corner,size:[.25,120,.25],rotation:Math.PI}),r.a.createElement(_,{position:[-12,0,-12],userData:C.b.corner,size:[.25,120,.25],rotation:Math.PI}),r.a.createElement(_,{position:[0,0,45],userData:C.b.roof,size:[24,24,.001],rotation:Math.PI/2}))}var T=a(31),k=a.n(T);function B(){var e=h((function(e){return e})).ballLaunched,t=Object(y.d)(x.TextureLoader,k.a),a=Object(E.e)((function(){return{mass:1,args:1,position:[0,0,0],onCollide:function(e){}}})),n=Object(s.a)(a,2),o=n[0],i=n[1];return Object(y.c)((function(t){e||(i.position.set(10*t.mouse.x,10*t.mouse.y,17.6),i.velocity.set(0,0,0,1))})),r.a.createElement("mesh",{castShadow:!0,receiveShadow:!0,ref:o},r.a.createElement("sphereBufferGeometry",{attach:"geometry",args:[.5,64,64]}),r.a.createElement("meshStandardMaterial",{map:t,attach:"material"}))}function L(){var e=Object(E.e)((function(){return{args:1.3,scale:[1,1,.01],position:[0,0,10],sleepSpeedLimit:4,onCollide:function(e){}}})),t=Object(s.a)(e,2),a=t[0],n=t[1];function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=e<0;return a?e<-t?-t:e:e>t?t:e}return Object(y.c)((function(e){var t=10*e.mouse.x,r=10*e.mouse.y,i=t-a.current.position.x,s=r-a.current.position.y;n.position.set(a.current.position.x+o(i),a.current.position.y+o(s),18)})),r.a.createElement(r.a.Fragment,null,r.a.createElement("mesh",{ref:a,castShadow:!0},r.a.createElement("boxGeometry",{attach:"geometry",args:[5,5,1]}),r.a.createElement("meshBasicMaterial",{attach:"material",wireframe:!0,color:"#FFF"})))}function R(){var e=Object(n.useRef)();return Object(n.useLayoutEffect)((function(){e.current.shadow.camera=new x.OrthographicCamera(-100,100,100,-100,.5,100),e.current.shadow.mapSize.width=2048,e.current.shadow.mapSize.height=2048}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("ambientLight",{intensity:.75}),r.a.createElement("directionalLight",{ref:e,position:[0,0,25],"shadow-camera-near":.1,"shadow-camera-far":1500,castShadow:!0}))}var I=a(33),A=a(32),U=a(34),N=a(35),q=a(4),H={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:"varying vec2 vUv;\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }",fragmentShader:"uniform int byp; //should we apply the glitch\n    uniform sampler2D tDiffuse;\n    uniform sampler2D tDisp;\n    uniform float amount;\n    uniform float angle;\n    uniform float seed;\n    uniform float seed_x;\n    uniform float seed_y;\n    uniform float distortion_x;\n    uniform float distortion_y;\n    uniform float col_s;\n    varying vec2 vUv;\n    float rand(vec2 co){\n      return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n    }\n    void main() {\n      if(byp<1) {\n        vec2 p = vUv;\n        float xs = floor(gl_FragCoord.x / 0.5);\n        float ys = floor(gl_FragCoord.y / 0.5);\n        //based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n        vec4 normal = texture2D (tDisp, p*seed*seed);\n        if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n          if(seed_x>0.){\n            p.y = 1. - (p.y + distortion_y);\n          }\n          else {\n            p.y = distortion_y;\n          }\n        }\n        p.x+=normal.x*seed_x*(seed/5.);\n        p.y+=normal.y*seed_y*(seed/5.);\n        //base from RGB shift shader\n        vec2 offset = amount * vec2( cos(angle), sin(angle));\n        vec4 cr = texture2D(tDiffuse, p + offset);\n        vec4 cga = texture2D(tDiffuse, p);\n        vec4 cb = texture2D(tDiffuse, p - offset);\n        gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n        //add noise\n        vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.05);\n        gl_FragColor = gl_FragColor+ snow;\n      }\n      else {\n        gl_FragColor=texture2D (tDiffuse, vUv);\n      }\n    }"},J=function(e){q.a.call(this),void 0===H&&console.error("THREE.GlitchPass relies on THREE.DigitalGlitch");var t=H;this.uniforms=x.UniformsUtils.clone(t.uniforms),void 0===e&&(e=64),this.uniforms.tDisp.value=this.generateHeightmap(e),this.material=new x.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.camera=new x.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new x.Scene,this.quad=new x.Mesh(new x.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.factor=0};function V(e){var t=Object(n.useContext)(F).glitching,a=Object(n.useRef)(),o=Object(y.e)(),i=o.scene,s=o.gl,c=o.size,l=Object(n.useMemo)((function(){return new x.Vector2(c.width,c.height)}),[c]);return Object(n.useEffect)((function(){a.current.setSize(c.width,c.height)}),[c]),Object(y.c)((function(){return a.current.render()}),1),r.a.createElement("effectComposer",{ref:a,args:[s]},r.a.createElement("renderPass",{attachArray:"passes",scene:i,camera:e.camera}),r.a.createElement("unrealBloomPass",{attachArray:"passes",args:[l,.25,.2,0]}),r.a.createElement("glitchPass",{attachArray:"passes",factor:t?1:0}),r.a.createElement("filmPass",{attachArray:"passes",args:[.35,.6,1500,!1]}))}function K(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],o=t[1],i={glitching:a,setGlitching:o},c=h((function(e){return e})),l=c.ballLaunched,u=c.launchBall,m=c.balls,f=c.resetGame,d=c.currentLevel,p=Object(n.useMemo)((function(){var e=new x.PerspectiveCamera(45,1,1,57);return e.position.set(0,0,45),e}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"game",onClick:function(){m<0?f():l||(u(),console.log(a))}},m>=0?r.a.createElement("div",{id:"canvas"},r.a.createElement(y.a,{shadowMap:!0,camera:p},r.a.createElement(F.Provider,{value:i},r.a.createElement(R,null),r.a.createElement(E.a,{iterations:20,tolerance:1e-4,defaultContactMaterial:{friction:0,restitution:1},gravity:[0,0,0],allowSleep:!1},r.a.createElement(G,null),r.a.createElement(z,null),r.a.createElement(L,null),r.a.createElement(B,null),r.a.createElement(V,{camera:p}))))):r.a.createElement("div",null,r.a.createElement("p",null,"Game Over"),r.a.createElement("p",null,"Click to restart")),r.a.createElement("div",{id:"hud"},r.a.createElement("p",null,"Balls: ",m),r.a.createElement("p",null,"Level: ",d),r.a.createElement("p",{onClick:f},"Click to restart"))))}J.prototype=Object.assign(Object.create(q.a.prototype),{constructor:J,render:function(e,t,a,n,r){var o=Math.max(0,this.factor);this.uniforms.tDiffuse.value=a.texture,this.uniforms.seed.value=Math.random()*o,this.uniforms.byp.value=0,o?(this.uniforms.amount.value=Math.random()/90*o,this.uniforms.angle.value=x.Math.randFloat(-Math.PI,Math.PI)*o,this.uniforms.distortion_x.value=x.Math.randFloat(0,1)*o,this.uniforms.distortion_y.value=x.Math.randFloat(0,1)*o,this.uniforms.seed_x.value=x.Math.randFloat(-.3,.3)*o,this.uniforms.seed_y.value=x.Math.randFloat(-.3,.3)*o):this.uniforms.byp.value=1,this.quad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera))},generateHeightmap:function(e){for(var t=new Float32Array(e*e*3),a=e*e,n=0;n<a;n++){var r=x.Math.randFloat(0,1);t[3*n+0]=r,t[3*n+1]=r,t[3*n+2]=r}var o=new x.DataTexture(t,e,e,x.RGBFormat,x.FloatType);return o.needsUpdate=!0,o}}),Object(y.b)({EffectComposer:I.a,RenderPass:A.a,UnrealBloomPass:U.a,FilmPass:N.a,GlitchPass:J});a(45);function Q(){var e=h((function(e){return e})).inGame;return r.a.createElement("div",{className:"main"},e?r.a.createElement(K,null):r.a.createElement(g,null))}a.d(t,"default",(function(){return Q})),i.a.render(r.a.createElement(Q,null),document.getElementById("root"))},5:function(e){e.exports=JSON.parse('{"a":{"red":{"color":"#fe5e51","bonusProbability":0,"strength":2,"score":500},"pink":{"color":"#ffb5ff","bonusProbability":0,"strength":1,"score":250},"blue":{"color":"#36abb5","bonusProbability":0,"strength":3,"score":1000},"yellow":{"color":"#f6db5f","bonusProbability":0,"strength":2,"score":500}},"b":{"side":{"color":"#5433FF"},"ground":{"color":"#5433FF"},"roof":{"isRoof":true,"color":"#000"},"corner":{"color":"#FFF","isCorner":true}}}')}},[[37,1,2]]]);
//# sourceMappingURL=main.9551db82.chunk.js.map